// SPDX-License-Identifier: GPL-3.0-or-later
// Copyright (c) 2023 Team Dissolve and contributors

#pragma once

#include "math/matrix4.h"
#include "sginfo/sginfo.h"
#include "templates/optionalref.h"
#include <string>
#include <vector>

// Space Group Symbol Table
namespace SpaceGroups
{
/* Space Groups
 * All 530 space group / setting combinations
 * 'a', 'b', 'c' indicate axis/setting choices, with capitalisation indicating negation.
 */
enum SpaceGroupId
{
    NoSpaceGroup,
    SpaceGroup_1,
    SpaceGroup_2,
    SpaceGroup_3_b,
    SpaceGroup_3_c,
    SpaceGroup_3_a,
    SpaceGroup_4_b,
    SpaceGroup_4_c,
    SpaceGroup_4_a,
    SpaceGroup_5_b1,
    SpaceGroup_5_b2,
    SpaceGroup_5_b3,
    SpaceGroup_5_c1,
    SpaceGroup_5_c2,
    SpaceGroup_5_c3,
    SpaceGroup_5_a1,
    SpaceGroup_5_a2,
    SpaceGroup_5_a3,
    SpaceGroup_6_b,
    SpaceGroup_6_c,
    SpaceGroup_6_a,
    SpaceGroup_7_b1,
    SpaceGroup_7_b2,
    SpaceGroup_7_b3,
    SpaceGroup_7_c1,
    SpaceGroup_7_c2,
    SpaceGroup_7_c3,
    SpaceGroup_7_a1,
    SpaceGroup_7_a2,
    SpaceGroup_7_a3,
    SpaceGroup_8_b1,
    SpaceGroup_8_b2,
    SpaceGroup_8_b3,
    SpaceGroup_8_c1,
    SpaceGroup_8_c2,
    SpaceGroup_8_c3,
    SpaceGroup_8_a1,
    SpaceGroup_8_a2,
    SpaceGroup_8_a3,
    SpaceGroup_9_b1,
    SpaceGroup_9_b2,
    SpaceGroup_9_b3,
    SpaceGroup_9_B1,
    SpaceGroup_9_B2,
    SpaceGroup_9_B3,
    SpaceGroup_9_c1,
    SpaceGroup_9_c2,
    SpaceGroup_9_c3,
    SpaceGroup_9_C1,
    SpaceGroup_9_C2,
    SpaceGroup_9_C3,
    SpaceGroup_9_a1,
    SpaceGroup_9_a2,
    SpaceGroup_9_a3,
    SpaceGroup_9_A1,
    SpaceGroup_9_A2,
    SpaceGroup_9_A3,
    SpaceGroup_10_b,
    SpaceGroup_10_c,
    SpaceGroup_10_a,
    SpaceGroup_11_b,
    SpaceGroup_11_c,
    SpaceGroup_11_a,
    SpaceGroup_12_b1,
    SpaceGroup_12_b2,
    SpaceGroup_12_b3,
    SpaceGroup_12_c1,
    SpaceGroup_12_c2,
    SpaceGroup_12_c3,
    SpaceGroup_12_a1,
    SpaceGroup_12_a2,
    SpaceGroup_12_a3,
    SpaceGroup_13_b1,
    SpaceGroup_13_b2,
    SpaceGroup_13_b3,
    SpaceGroup_13_c1,
    SpaceGroup_13_c2,
    SpaceGroup_13_c3,
    SpaceGroup_13_a1,
    SpaceGroup_13_a2,
    SpaceGroup_13_a3,
    SpaceGroup_14_b1,
    SpaceGroup_14_b2,
    SpaceGroup_14_b3,
    SpaceGroup_14_c1,
    SpaceGroup_14_c2,
    SpaceGroup_14_c3,
    SpaceGroup_14_a1,
    SpaceGroup_14_a2,
    SpaceGroup_14_a3,
    SpaceGroup_15_b1,
    SpaceGroup_15_b2,
    SpaceGroup_15_b3,
    SpaceGroup_15_B1,
    SpaceGroup_15_B2,
    SpaceGroup_15_B3,
    SpaceGroup_15_c1,
    SpaceGroup_15_c2,
    SpaceGroup_15_c3,
    SpaceGroup_15_C1,
    SpaceGroup_15_C2,
    SpaceGroup_15_C3,
    SpaceGroup_15_a1,
    SpaceGroup_15_a2,
    SpaceGroup_15_a3,
    SpaceGroup_15_A1,
    SpaceGroup_15_A2,
    SpaceGroup_15_A3,
    SpaceGroup_16,
    SpaceGroup_17,
    SpaceGroup_17_cab,
    SpaceGroup_17_bca,
    SpaceGroup_18,
    SpaceGroup_18_cab,
    SpaceGroup_18_bca,
    SpaceGroup_19,
    SpaceGroup_20,
    SpaceGroup_20_cab,
    SpaceGroup_20_bca,
    SpaceGroup_21,
    SpaceGroup_21_cab,
    SpaceGroup_21_bca,
    SpaceGroup_22,
    SpaceGroup_23,
    SpaceGroup_24,
    SpaceGroup_25,
    SpaceGroup_25_cab,
    SpaceGroup_25_bca,
    SpaceGroup_26,
    SpaceGroup_26_baC,
    SpaceGroup_26_cab,
    SpaceGroup_26_Cba,
    SpaceGroup_26_bca,
    SpaceGroup_26_aCb,
    SpaceGroup_27,
    SpaceGroup_27_cab,
    SpaceGroup_27_bca,
    SpaceGroup_28,
    SpaceGroup_28_baC,
    SpaceGroup_28_cab,
    SpaceGroup_28_Cba,
    SpaceGroup_28_bca,
    SpaceGroup_28_aCb,
    SpaceGroup_29,
    SpaceGroup_29_baC,
    SpaceGroup_29_cab,
    SpaceGroup_29_Cba,
    SpaceGroup_29_bca,
    SpaceGroup_29_aCb,
    SpaceGroup_30,
    SpaceGroup_30_baC,
    SpaceGroup_30_cab,
    SpaceGroup_30_Cba,
    SpaceGroup_30_bca,
    SpaceGroup_30_aCb,
    SpaceGroup_31,
    SpaceGroup_31_baC,
    SpaceGroup_31_cab,
    SpaceGroup_31_Cba,
    SpaceGroup_31_bca,
    SpaceGroup_31_aCb,
    SpaceGroup_32,
    SpaceGroup_32_cab,
    SpaceGroup_32_bca,
    SpaceGroup_33,
    SpaceGroup_33_baC,
    SpaceGroup_33_cab,
    SpaceGroup_33_Cba,
    SpaceGroup_33_bca,
    SpaceGroup_33_aCb,
    SpaceGroup_34,
    SpaceGroup_34_cab,
    SpaceGroup_34_bca,
    SpaceGroup_35,
    SpaceGroup_35_cab,
    SpaceGroup_35_bca,
    SpaceGroup_36,
    SpaceGroup_36_baC,
    SpaceGroup_36_cab,
    SpaceGroup_36_Cba,
    SpaceGroup_36_bca,
    SpaceGroup_36_aCb,
    SpaceGroup_37,
    SpaceGroup_37_cab,
    SpaceGroup_37_bca,
    SpaceGroup_38,
    SpaceGroup_38_baC,
    SpaceGroup_38_cab,
    SpaceGroup_38_Cba,
    SpaceGroup_38_bca,
    SpaceGroup_38_aCb,
    SpaceGroup_39,
    SpaceGroup_39_baC,
    SpaceGroup_39_cab,
    SpaceGroup_39_Cba,
    SpaceGroup_39_bca,
    SpaceGroup_39_aCb,
    SpaceGroup_40,
    SpaceGroup_40_baC,
    SpaceGroup_40_cab,
    SpaceGroup_40_Cba,
    SpaceGroup_40_bca,
    SpaceGroup_40_aCb,
    SpaceGroup_41,
    SpaceGroup_41_baC,
    SpaceGroup_41_cab,
    SpaceGroup_41_Cba,
    SpaceGroup_41_bca,
    SpaceGroup_41_aCb,
    SpaceGroup_42,
    SpaceGroup_42_cab,
    SpaceGroup_42_bca,
    SpaceGroup_43,
    SpaceGroup_43_cab,
    SpaceGroup_43_bca,
    SpaceGroup_44,
    SpaceGroup_44_cab,
    SpaceGroup_44_bca,
    SpaceGroup_45,
    SpaceGroup_45_cab,
    SpaceGroup_45_bca,
    SpaceGroup_46,
    SpaceGroup_46_baC,
    SpaceGroup_46_cab,
    SpaceGroup_46_Cba,
    SpaceGroup_46_bca,
    SpaceGroup_46_aCb,
    SpaceGroup_47,
    SpaceGroup_48_1,
    SpaceGroup_48_2,
    SpaceGroup_49,
    SpaceGroup_49_cab,
    SpaceGroup_49_bca,
    SpaceGroup_50_1,
    SpaceGroup_50_2,
    SpaceGroup_50_1cab,
    SpaceGroup_50_2cab,
    SpaceGroup_50_1bca,
    SpaceGroup_50_2bca,
    SpaceGroup_51,
    SpaceGroup_51_baC,
    SpaceGroup_51_cab,
    SpaceGroup_51_Cba,
    SpaceGroup_51_bca,
    SpaceGroup_51_aCb,
    SpaceGroup_52,
    SpaceGroup_52_baC,
    SpaceGroup_52_cab,
    SpaceGroup_52_Cba,
    SpaceGroup_52_bca,
    SpaceGroup_52_aCb,
    SpaceGroup_53,
    SpaceGroup_53_baC,
    SpaceGroup_53_cab,
    SpaceGroup_53_Cba,
    SpaceGroup_53_bca,
    SpaceGroup_53_aCb,
    SpaceGroup_54,
    SpaceGroup_54_baC,
    SpaceGroup_54_cab,
    SpaceGroup_54_Cba,
    SpaceGroup_54_bca,
    SpaceGroup_54_aCb,
    SpaceGroup_55,
    SpaceGroup_55_cab,
    SpaceGroup_55_bca,
    SpaceGroup_56,
    SpaceGroup_56_cab,
    SpaceGroup_56_bca,
    SpaceGroup_57,
    SpaceGroup_57_baC,
    SpaceGroup_57_cab,
    SpaceGroup_57_Cba,
    SpaceGroup_57_bca,
    SpaceGroup_57_aCb,
    SpaceGroup_58,
    SpaceGroup_58_cab,
    SpaceGroup_58_bca,
    SpaceGroup_59_1,
    SpaceGroup_59_2,
    SpaceGroup_59_1cab,
    SpaceGroup_59_2cab,
    SpaceGroup_59_1bca,
    SpaceGroup_59_2bca,
    SpaceGroup_60,
    SpaceGroup_60_baC,
    SpaceGroup_60_cab,
    SpaceGroup_60_Cba,
    SpaceGroup_60_bca,
    SpaceGroup_60_aCb,
    SpaceGroup_61,
    SpaceGroup_61_baC,
    SpaceGroup_62,
    SpaceGroup_62_baC,
    SpaceGroup_62_cab,
    SpaceGroup_62_Cba,
    SpaceGroup_62_bca,
    SpaceGroup_62_aCb,
    SpaceGroup_63,
    SpaceGroup_63_baC,
    SpaceGroup_63_cab,
    SpaceGroup_63_Cba,
    SpaceGroup_63_bca,
    SpaceGroup_63_aCb,
    SpaceGroup_64,
    SpaceGroup_64_baC,
    SpaceGroup_64_cab,
    SpaceGroup_64_Cba,
    SpaceGroup_64_bca,
    SpaceGroup_64_aCb,
    SpaceGroup_65,
    SpaceGroup_65_cab,
    SpaceGroup_65_bca,
    SpaceGroup_66,
    SpaceGroup_66_cab,
    SpaceGroup_66_bca,
    SpaceGroup_67,
    SpaceGroup_67_baC,
    SpaceGroup_67_cab,
    SpaceGroup_67_Cba,
    SpaceGroup_67_bca,
    SpaceGroup_67_aCb,
    SpaceGroup_68_1,
    SpaceGroup_68_2,
    SpaceGroup_68_1baC,
    SpaceGroup_68_2baC,
    SpaceGroup_68_1cab,
    SpaceGroup_68_2cab,
    SpaceGroup_68_1Cba,
    SpaceGroup_68_2Cba,
    SpaceGroup_68_1bca,
    SpaceGroup_68_2bca,
    SpaceGroup_68_1aCb,
    SpaceGroup_68_2aCb,
    SpaceGroup_69,
    SpaceGroup_70_1,
    SpaceGroup_70_2,
    SpaceGroup_71,
    SpaceGroup_72,
    SpaceGroup_72_cab,
    SpaceGroup_72_bca,
    SpaceGroup_73,
    SpaceGroup_73_baC,
    SpaceGroup_74,
    SpaceGroup_74_baC,
    SpaceGroup_74_cab,
    SpaceGroup_74_Cba,
    SpaceGroup_74_bca,
    SpaceGroup_74_aCb,
    SpaceGroup_75,
    SpaceGroup_76,
    SpaceGroup_77,
    SpaceGroup_78,
    SpaceGroup_79,
    SpaceGroup_80,
    SpaceGroup_81,
    SpaceGroup_82,
    SpaceGroup_83,
    SpaceGroup_84,
    SpaceGroup_85_1,
    SpaceGroup_85_2,
    SpaceGroup_86_1,
    SpaceGroup_86_2,
    SpaceGroup_87,
    SpaceGroup_88_1,
    SpaceGroup_88_2,
    SpaceGroup_89,
    SpaceGroup_90,
    SpaceGroup_91,
    SpaceGroup_92,
    SpaceGroup_93,
    SpaceGroup_94,
    SpaceGroup_95,
    SpaceGroup_96,
    SpaceGroup_97,
    SpaceGroup_98,
    SpaceGroup_99,
    SpaceGroup_100,
    SpaceGroup_101,
    SpaceGroup_102,
    SpaceGroup_103,
    SpaceGroup_104,
    SpaceGroup_105,
    SpaceGroup_106,
    SpaceGroup_107,
    SpaceGroup_108,
    SpaceGroup_109,
    SpaceGroup_110,
    SpaceGroup_111,
    SpaceGroup_112,
    SpaceGroup_113,
    SpaceGroup_114,
    SpaceGroup_115,
    SpaceGroup_116,
    SpaceGroup_117,
    SpaceGroup_118,
    SpaceGroup_119,
    SpaceGroup_120,
    SpaceGroup_121,
    SpaceGroup_122,
    SpaceGroup_123,
    SpaceGroup_124,
    SpaceGroup_125_1,
    SpaceGroup_125_2,
    SpaceGroup_126_1,
    SpaceGroup_126_2,
    SpaceGroup_127,
    SpaceGroup_128,
    SpaceGroup_129_1,
    SpaceGroup_129_2,
    SpaceGroup_130_1,
    SpaceGroup_130_2,
    SpaceGroup_131,
    SpaceGroup_132,
    SpaceGroup_133_1,
    SpaceGroup_133_2,
    SpaceGroup_134_1,
    SpaceGroup_134_2,
    SpaceGroup_135,
    SpaceGroup_136,
    SpaceGroup_137_1,
    SpaceGroup_137_2,
    SpaceGroup_138_1,
    SpaceGroup_138_2,
    SpaceGroup_139,
    SpaceGroup_140,
    SpaceGroup_141_1,
    SpaceGroup_141_2,
    SpaceGroup_142_1,
    SpaceGroup_142_2,
    SpaceGroup_143,
    SpaceGroup_144,
    SpaceGroup_145,
    SpaceGroup_146_H,
    SpaceGroup_146_R,
    SpaceGroup_147,
    SpaceGroup_148_H,
    SpaceGroup_148_R,
    SpaceGroup_149,
    SpaceGroup_150,
    SpaceGroup_151,
    SpaceGroup_152,
    SpaceGroup_153,
    SpaceGroup_154,
    SpaceGroup_155_H,
    SpaceGroup_155_R,
    SpaceGroup_156,
    SpaceGroup_157,
    SpaceGroup_158,
    SpaceGroup_159,
    SpaceGroup_160_H,
    SpaceGroup_160_R,
    SpaceGroup_161_H,
    SpaceGroup_161_R,
    SpaceGroup_162,
    SpaceGroup_163,
    SpaceGroup_164,
    SpaceGroup_165,
    SpaceGroup_166_H,
    SpaceGroup_166_R,
    SpaceGroup_167_H,
    SpaceGroup_167_R,
    SpaceGroup_168,
    SpaceGroup_169,
    SpaceGroup_170,
    SpaceGroup_171,
    SpaceGroup_172,
    SpaceGroup_173,
    SpaceGroup_174,
    SpaceGroup_175,
    SpaceGroup_176,
    SpaceGroup_177,
    SpaceGroup_178,
    SpaceGroup_179,
    SpaceGroup_180,
    SpaceGroup_181,
    SpaceGroup_182,
    SpaceGroup_183,
    SpaceGroup_184,
    SpaceGroup_185,
    SpaceGroup_186,
    SpaceGroup_187,
    SpaceGroup_188,
    SpaceGroup_189,
    SpaceGroup_190,
    SpaceGroup_191,
    SpaceGroup_192,
    SpaceGroup_193,
    SpaceGroup_194,
    SpaceGroup_195,
    SpaceGroup_196,
    SpaceGroup_197,
    SpaceGroup_198,
    SpaceGroup_199,
    SpaceGroup_200,
    SpaceGroup_201_1,
    SpaceGroup_201_2,
    SpaceGroup_202,
    SpaceGroup_203_1,
    SpaceGroup_203_2,
    SpaceGroup_204,
    SpaceGroup_205,
    SpaceGroup_206,
    SpaceGroup_207,
    SpaceGroup_208,
    SpaceGroup_209,
    SpaceGroup_210,
    SpaceGroup_211,
    SpaceGroup_212,
    SpaceGroup_213,
    SpaceGroup_214,
    SpaceGroup_215,
    SpaceGroup_216,
    SpaceGroup_217,
    SpaceGroup_218,
    SpaceGroup_219,
    SpaceGroup_220,
    SpaceGroup_221,
    SpaceGroup_222_1,
    SpaceGroup_222_2,
    SpaceGroup_223,
    SpaceGroup_224_1,
    SpaceGroup_224_2,
    SpaceGroup_225,
    SpaceGroup_226,
    SpaceGroup_227_1,
    SpaceGroup_227_2,
    SpaceGroup_228_1,
    SpaceGroup_228_2,
    SpaceGroup_229,
    SpaceGroup_230,
    nSpaceGroupIds
};

// Space Group Symbols
class SpaceGroupSymbol
{
    public:
    SpaceGroupSymbol(SpaceGroupId id, int sgNumber, std::string_view sgCode, std::string_view hmSymbol,
                     std::string_view hallSymbol);

    private:
    // Space Group ID
    SpaceGroups::SpaceGroupId id_;
    // Space group index in International Tables (1 - 230)
    int internationalTableIndex_;
    // Space group code (if any)
    std::string code_;
    // Hermann-Mauginn symbol
    std::string hermannMauginnSymbol_;
    // Condensed Hermann-Mauginn symbol (no spaces)
    std::string condensedHermannMauginnSymbol_;
    // Hall symbol
    std::string hallSymbol_;

    public:
    // Return space Group ID
    SpaceGroups::SpaceGroupId id() const;
    // Return space group index in International Tables (1 - 230)
    int internationalTableIndex() const;
    // Return space group code (if any)
    const std::string &code() const;
    // Return Hermann-Mauginn symbol
    const std::string &hermannMauginnSymbol() const;
    // Return condensed Hermann-Mauginn symbol (no spaces)
    const std::string &condensedHermannMauginnSymbol() const;
    // Return Hall symbol
    const std::string &hallSymbol() const;
};

// Find space group from supplied Hall symbol
SpaceGroups::SpaceGroupId findByHallSymbol(std::string_view hallSymbol);
// Find space group from supplied Hermann-Mauginn symbol and (optional) code
SpaceGroups::SpaceGroupId findByHermannMauginnSymbol(std::string_view hmSymbol, std::string_view code = "");
// Find space group from supplied International Tables index and (optional) code
SpaceGroups::SpaceGroupId findByInternationalTablesIndex(int itIndex, std::string_view code = "");
// Return index of the supplied space group id in the International Tables
int internationalTableIndex(SpaceGroupId sgid);
// Return full set of symmetry operators for the supplied space group id
std::vector<Matrix4> symmetryOperators(SpaceGroupId sgid);
// Return formatted name for the supplied space group id
std::string formattedInformation(SpaceGroupId sgid);

}; // namespace SpaceGroups
