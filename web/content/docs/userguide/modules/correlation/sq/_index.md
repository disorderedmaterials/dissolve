---
title: SQ (Module)
linkTitle: SQ
description: Unweighted structure factors
---

## Overview

The `SQ` module calculates the atomic structure factors, $S(Q)$, via Fourier transform of a source set of radial distribution functions. The total structure factor, $F(Q)$, is also generated through summation of the atomic partials.

The required radial distribution functions must be calculated by an [`RDF`]({{< ref "rdf" >}}) module and referenced using the [`SourceRDFs`](#control-keywords) keyword.

The [`RDF`]({{< ref "rdf" >}}) module dictates the target configurations from which the $g(r)$, and hence the $S(Q)$, are generated - as such, the `SQ` module does not target any configurations itself.

## Description

### Basic Theory

For a configuration containing $N$ distinct atom types there are $\frac{1}{2}N(N+1)$ unique partial structure factors $S_{ij}(Q)$, where $i$ and $j$ are the $i^{th}$ and $j^{th}$ atom type respectively. In the Faber-Ziman formalism, these partial structure factors are related to the radial distribution function via Fourier transform as follows:

$$ S_{ij}(Q) = 4\pi\rho \int_0^\inf [g_{ij}(r)-1] \frac{sin(Qr)}{Qr} r^2 dr $$

where $g_{ij}(r)$ is the radial distribution function between atom types $i$ and $j$, and $\rho$ is the atomic number density of the system. The full structure factor $F(Q)$, is the sum of the partials weighted by the atomic concentrations $c$ of the atom type involved:

$$ F(Q) = \sum^N_{i,j,i \geq j}  [2-\delta_{ij}] c_i c_j S_{ij}(Q) $$

### Instrumental Broadening

Any broadening arising from instrumental effects (i.e. instrumental broadening) can be applied to the calculated $S(Q)$ with the [`QBroadening`](#control-keywords) keyword. Any modules that apply weighting factors (e.g. [`NeutronSQ`]({{< ref "neutronsq" >}})) to the structure factors generated by `SQ` will therefore also contain this broadening. If data from different sources with differing broadening functions is required, then multiple `SQ` modules must be used.

## Configuration

### Control Keywords

|Keyword|Arguments|Default|Description|
|:------|:--:|:-----:|-----------|
|`Averaging`|`n`|`5`|Number of historical partial sets to combine into final partials|
|`AveragingScheme`|[`AveragingScheme`]({{< ref "averagingscheme" >}})|`Linear`|Weighting scheme to use when averaging partials|
|`QDelta`|`qdelta`|`0.01`|Step size in $Q$ for Fourier transform.|
|`QMax`|`qmax`|`30.0`|$Q_{max}$ limit of Fourier transform.|
|`QMin`|`qmin`|`0.01`|$Q_{min}$ limit of Fourier transform.|
|`QBroadening`|[`BroadeningFunction`]({{< ref "averagingscheme" >}})|`None`|Broadening function to convolve in the Fourier transform.|
|`SourceRDFs`|`Module`|--|{{< required-label >}} Source [`RDF`]({{< ref "rdf" >}}) module from which to take $g(r)$ and transform to $S(Q)$.|
|`WindowFunction`|[`WindowFunction`]({{< ref "averagingscheme" >}})|`None`|Window function to apply in the Fourier transform.|

### Export Keywords

|Keyword|Arguments|Default|Description|
|:------|:--:|:-----:|-----------|
|`Export`|`true|false`|`false`|Whether to save partials to disk after calculation. A separate file is written for each individual atomic partial between types $i$ and $j$, as well as the summed total.|
